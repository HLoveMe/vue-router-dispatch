!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r(require("vue-router"),require("rxjs"),require("rxjs/operators"),require("vue")):"function"==typeof define&&define.amd?define(["vue-router","rxjs","rxjs/operators","vue"],r):"object"==typeof exports?exports.Pin=r(require("vue-router"),require("rxjs"),require("rxjs/operators"),require("vue")):e.Pin=r(e["vue-router"],e.rxjs,e["rxjs/operators"],e.vue)}(self,((e,r,n,t)=>(()=>{"use strict";var o={832:e=>{e.exports=r},597:e=>{e.exports=n},748:e=>{e.exports=t},557:r=>{r.exports=e}},u={};function i(e){var r=u[e];if(void 0!==r)return r.exports;var n=u[e]={exports:{}};return o[e](n,n.exports,i),n.exports}i.d=(e,r)=>{for(var n in r)i.o(r,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},i.o=(e,r)=>Object.prototype.hasOwnProperty.call(e,r),i.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var c={};return(()=>{i.r(c),i.d(c,{VueRouterPin:()=>w,dispatchEvent:()=>E,useRoutePin:()=>R,useRouterPin:()=>q});var e=i(557),r=i(832);function n(){}var t="function"==typeof Symbol&&"symbol"==typeof Symbol.toStringTag,o=function(e){return t?Symbol.for("[r-server]: "+e):"[r-server]: "+e},u=o("event-init"),a=o("GlobalRServerKey"),l=o("CurrentRServerKey"),f=new Map,s={type:u,data:null,reject:n,resolve:n,source:void 0},p={id:"",channelCenter:new r.BehaviorSubject(s),errorChanel:new r.Subject,children:[],clearSubs:[]},v={id:a,router:void 0,children:[],channelCenter:new r.BehaviorSubject(s),errorChanel:new r.Subject,clearSubs:[]},h=function(){console.error("please install vue-router-pin")},d={on:h,onBehavior:h,once:h,onError:h,dispatch:h,dispatchAsync:h},b=function(){return b=Object.assign||function(e){for(var r,n=1,t=arguments.length;n<t;n++)for(var o in r=arguments[n])Object.prototype.hasOwnProperty.call(r,o)&&(e[o]=r[o]);return e},b.apply(this,arguments)};Object.create,Object.create;var y=i(597),j=i(748),x=function(e){var n={},t=e.fullPath,u=o(t),i=f.get(u);return i?n=i:(n.id=o(e.fullPath),n.route=e,n.children=[],n.clearSubs=[],n.channelCenter=new r.BehaviorSubject(s)),n},S=function(e,r){return r instanceof RegExp?"string"==typeof e.type&&r.test(e.type):e.type===r},m=(0,j.shallowRef)(p);function g(e,r){r&&r.unsubscribe();var n=e.clearSubs.indexOf(r);n>-1&&e.clearSubs.splice(n,1)}function C(e,n,t){void 0===t&&(t=!1);var o=e.channelCenter,u=e.id,i=e.errorChanel,c=u===a;if(!1===t)return o.next(n),void(c&&e.children.forEach((function(e){return e.channelCenter.next(n)})));var l=n.resolve,f=n.reject,s=(0,r.from)(new Promise((function(e,r){o.next(b(b({},n),{resolve:e,reject:r}))}))),p=e.children.map((function(e){return(0,r.from)(new Promise((function(r,t){e.channelCenter.next(b(b({},n),{resolve:r,reject:t}))})))}));r.zip.apply(void 0,function(e,r,n){if(n||2===arguments.length)for(var t,o=0,u=r.length;o<u;o++)!t&&o in r||(t||(t=Array.prototype.slice.call(r,0,o)),t[o]=r[o]);return e.concat(t||Array.prototype.slice.call(r))}([s],p,!1)).pipe((0,y.takeLast)(1)).subscribe({next:function(e){return l(e)},complete:function(){},error:function(e){f(e),i.next(e)}})}var P=function(e,r){var n=v.router,t=function(r){if(0==!!r)return e;if(e.id!==a)return e;var t=n.resolve(r).fullPath,u=o(t);return f.get(u)||e};return{dispatch:function(e,n,o){C(t(o),{type:e,data:n,source:r,resolve:function(){},reject:function(){}})},dispatchAsync:function(e,n,o){return new Promise((function(u,i){C(t(o),{type:e,data:n,source:r,resolve:function(e){return u(e)},reject:function(e){return i(e)}},!0)}))},on:function(r,n){return function(e,r,n){var t=e.channelCenter,o=e.errorChanel,i=t.pipe((0,y.filter)((function(e){return S(e,r)||e.type===u})),(0,y.bufferCount)(2,1),(0,y.map)((function(e){return e[1]}))).subscribe({complete:function(){return g(e,i)},next:function(e){return n&&n(e)},error:function(e){return o.next(e)}});return e.clearSubs.push(i),{close:function(){return g(e,i)}}}(e,r,n)},onBehavior:function(r,n){return function(e,r,n){var t=e.channelCenter,o=e.errorChanel,i=t.pipe((0,y.filter)((function(e){return S(e,r)&&e.type!==u}))).subscribe({complete:function(){return g(e,i)},next:function(e){return n&&n(e)},error:function(e){return o.next(e)}});return e.clearSubs.push(i),{close:function(){return g(e,i)}}}(e,r,n)},once:function(r,n){return function(e,r,n){var t=e.channelCenter,o=e.errorChanel,i=t.pipe((0,y.filter)((function(e){return S(e,r)||e.type===u})),(0,y.bufferCount)(2,1),(0,y.map)((function(e){return e[1]})),(0,y.take)(1)).subscribe({complete:function(){return g(e,i)},next:function(e){return n&&n(e)},error:function(e){return o.next(e)}});return e.clearSubs.push(i),{close:function(){return g(e,i)}}}(e,r,n)},onError:function(r){return function(e,r){var n=e.errorChanel.subscribe({complete:function(){g(e,n)},next:function(e){r&&r(e)}});return e.clearSubs.push(n),{close:function(){return g(e,n)}}}(e,r)}}};const w=(O={install:function(n){var t;(t=n.config.globalProperties.$router).beforeEach((function(e,r){var n=x(e);f.has(n.id)||v.children.push(n),f.set(n.id,n),m.value=n})),t.afterEach((function(e,r){m.value=x(e)})),v.channelCenter=new r.BehaviorSubject(s),v.router=t,f.set(v.id,v),m.value=v,n.provide(a,v),n.provide(l,m),n.config.globalProperties.$rs=function(r,n){C(m.value,{type:r,data:n,source:(0,e.useRoute)(),resolve:function(){},reject:function(){}})}},dispatch:function(e,r){for(var t=[],u=2;u<arguments.length;u++)t[u-2]=arguments[u];var i=!1,c=void 0;2===(t=t.filter((function(e){return void 0!==e}))).length?(i=t[0],c=t[1]):1===t.length?"boolean"==typeof t[0]?(i=t[0],c=void 0):(c=t[0],i=!1):(c=void 0,i=!1);var a=void 0;if(0==!!c)a=v;else{var l=v.router,s=l.resolve(c).fullPath,p=o(s);a=f.get(p)}return new Promise((function(t,o){C(a,{type:e,data:r,source:void 0,resolve:i?t:n,reject:i?o:n},!!i),i||t(null)}))}},O);var O;function R(){var r=(0,j.inject)(l);return r?P(r.value,(0,e.useRoute)()):d}function q(){var r=(0,j.inject)(a);return r?P(r,(0,e.useRouter)()):d}function E(e,r,n,t){return w.dispatch(e,r,n,t)}})(),c})()));